<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live Location</title>
<link rel="stylesheet" 
  href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
<style>
  #map { height: 500px }
</style>
</head>
<body>

<h1>Live Location</h1>
<div id="map"></div>

<script>
  // âš¡ Change this to YOUR Glitch backend's URL:
  const socket = io('https://your-glitch-app-name.glitch.me');  

  // Initialize the map
  const map = L.map('map').setView([0, 0], 2);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
    .addTo(map);

  // Handle location messages from server
  socket.on('location', (data) => {
    L.marker([data.lat, data.lng]).addTo(map);
  });

  // Send your own location and show it immediately
  navigator.geolocation.getCurrentPosition((pos) => {
    const coords = { lat: pos.coords.latitude, lng: pos.coords.longitude };
    socket.emit('location', coords);
    L.marker([coords.lat, coords.lng]).addTo(map);
    map.setView([coords.lat, coords.lng], 13);
  });
</script>

</body>
</html>
